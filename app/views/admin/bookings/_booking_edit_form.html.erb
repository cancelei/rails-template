<%# locals: (booking:) %>
<%= turbo_frame_tag dom_id(booking), target: "_top" do %>
<tr>
  <td colspan="5" class="px-4 sm:px-6 py-4">
    <div class="card">
      <div class="card-body">
        <%= form_with model: [:admin, booking], method: :patch, data: { turbo_frame: dom_id(booking) } do |f| %>
          <h3 class="text-xl font-semibold text-foreground mb-4">Edit Booking</h3>
          <p class="text-sm text-muted-foreground mb-4">
            <%= booking.tour.title %> - <%= booking.user.name %>
          </p>

          <% if booking.errors.any? %>
            <div class="alert alert-danger mb-4">
              <h4 class="font-semibold mb-2"><%= pluralize(booking.errors.count, "error") %> prevented this booking from being saved:</h4>
              <ul class="text-sm list-disc list-inside">
                <% booking.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <div class="space-y-4">
            <div class="form-group">
              <%= f.label :status, "Booking Status", class: "form-label form-label-required" %>
              <%= f.select :status,
                           [%w[Pending pending], %w[Confirmed confirmed], %w[Completed completed], %w[Cancelled cancelled]],
                           {},
                           class: "form-input",
                           required: true %>
            </div>

            <div class="form-group">
              <%= f.label :notes, class: "form-label" %>
              <%= f.text_area :notes, rows: 3, class: "form-input", placeholder: "Add any notes about this booking..." %>
            </div>

            <div class="flex gap-3 pt-4 border-t border-border">
              <%= f.submit "Save Changes", class: "btn-booking", data: { controller: "loading-state", action: "loading-state#showLoading" } %>
              <%= link_to "Cancel",
                          admin_booking_path(booking),
                          class: "btn-booking-secondary",
                          data: { turbo_frame: dom_id(booking), turbo_action: "replace" } %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </td>
</tr>
<% end %>
