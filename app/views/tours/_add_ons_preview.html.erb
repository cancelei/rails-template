<%# locals: (tour:) %>

<% active_add_ons = tour.tour_add_ons.active.by_position %>

<% if active_add_ons.any? %>
  <div class="card">
    <div class="card-body">
      <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
        <span>âœ¨</span>
        <span>Enhance Your Experience</span>
      </h2>
      <p class="text-sm text-muted-foreground mb-4">
        Add these optional extras to make your tour even more special
      </p>

      <div class="space-y-3">
        <% active_add_ons.each do |add_on| %>
          <div class="addon-preview-card">
            <div class="flex items-start gap-3">
              <div class="text-2xl flex-shrink-0">
                <%= add_on.addon_type_icon %>
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between gap-2">
                  <div class="flex-1">
                    <h3 class="font-semibold text-foreground text-sm">
                      <%= add_on.name %>
                    </h3>
                    <% if add_on.description.present? %>
                      <p class="text-xs text-muted-foreground mt-1 line-clamp-2">
                        <%= add_on.description %>
                      </p>
                    <% end %>
                  </div>
                  <div class="text-right flex-shrink-0">
                    <p class="font-semibold text-primary text-sm whitespace-nowrap">
                      <%= add_on.formatted_price %>
                    </p>
                    <% if add_on.pricing_type_per_person? %>
                      <p class="text-xs text-muted-foreground">per person</p>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <div class="mt-4 p-3 bg-muted rounded-lg">
        <p class="text-xs text-muted-foreground text-center">
          ðŸ’¡ You can select these add-ons when booking below
        </p>
      </div>
    </div>
  </div>
<% end %>
