test:
  service: Disk
  root: <%= Rails.root.join("tmp/storage") %>

local:
  service: Disk
  root: <%= Rails.root.join("storage") %>

# iDrive e2 Storage (S3-compatible)
# Development environment - uses local disk for faster iteration
idrive_development:
  service: S3
  access_key_id: <%= ENV['IDRIVE_E2_ACCESS_KEY_ID'] %>
  secret_access_key: <%= ENV['IDRIVE_E2_SECRET_ACCESS_KEY'] %>
  region: us-east-1  # iDrive e2 doesn't use regions, but AWS SDK requires it
  bucket: <%= ENV.fetch('IDRIVE_E2_BUCKET_DEVELOPMENT', 'guide-development') %>
  endpoint: https://s3.us-southwest-1.idrivee2.com
  force_path_style: true  # Required for iDrive e2
  upload:
    # Cache files for 1 year - adjust based on your needs
    # private: browser can cache, but CDNs should not
    cache_control: 'private, max-age=<%= 365.days.to_i %>'

# Staging environment
idrive_staging:
  service: S3
  access_key_id: <%= ENV['IDRIVE_E2_ACCESS_KEY_ID'] %>
  secret_access_key: <%= ENV['IDRIVE_E2_SECRET_ACCESS_KEY'] %>
  region: us-east-1
  bucket: <%= ENV.fetch('IDRIVE_E2_BUCKET_STAGING', 'guide-staging') %>
  endpoint: https://s3.us-southwest-1.idrivee2.com
  force_path_style: true
  upload:
    cache_control: 'private, max-age=<%= 365.days.to_i %>'

# Production environment
idrive_production:
  service: S3
  access_key_id: <%= ENV['IDRIVE_E2_ACCESS_KEY_ID'] %>
  secret_access_key: <%= ENV['IDRIVE_E2_SECRET_ACCESS_KEY'] %>
  region: us-east-1
  bucket: <%= ENV.fetch('IDRIVE_E2_BUCKET_PRODUCTION', 'guide-production') %>
  endpoint: https://s3.us-southwest-1.idrivee2.com
  force_path_style: true
  upload:
    cache_control: 'public, max-age=<%= 365.days.to_i %>'  # public for better CDN caching
